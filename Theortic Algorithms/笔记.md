继第一次测验后课程

# 试除法

primary tests trial divisors

## 定义

> 试除法是一种寻找一个数的因子的方法。具体而言，它通过将待测数除以从2开始的连续整数，直到找到一个因子或者被除数小于等于除数为止。

$$
如果 n是一个合数(非素数)，那么n的最小质因数P\le\sqrt n\\
证明过程:n=P\cdot n\geq P^2\implies \sqrt n\geq P
$$



## 举个🌰

> 101是素数吗？

$$
所有可能的质因数范围:\sqrt {101}\le11\implies P=\{2,3,5,7\}\\
都无法整除\implies101是素数
$$

> 1001是素数吗？

$$
\sqrt {1001}\le31,P=\{2,3,5,7...,31\}\\
1001 \ mod\ 7 =0\ mod\ 7\implies1001不是素数
$$

# 费马素性测试

Fermat primary tests--基于费马小定理的素数测试方法

## 定理

$$
\phi(p^m)=p^m - p^{m-1},\phi(p)=p - 1\\p是一个质数，那么对于任意整数a,(1 < a < p)或者可以表示\ P\nmid a\\
a^{\phi(n)}\equiv1(mod\ n )\\a^{p - 1}\equiv1(mod\ p )\\a^{p }\equiv a(mod\ p ),
$$

> 如果计算结果等于1，则p可能是质数也可能是合数（如卡梅里克数等特殊情况）
>
> 如果计算结果不等于1，则p一定是合数。

## 卡梅里克数

$$
现在给了你一个P\ge 2,P是质数吗?\\
我们可以任意取一个A_1,A_1\in \N ,我们来进行费马测试\\
\begin{cases}
A_i^{p }\equiv A_i(mod\ p )\implies可能是质数也可能是合数\\
A_i^{p }\not\equiv A_i(mod\ p ) \implies非质数\\
\end{cases}\\
当越来越多的A_i被核实，那么P是质数的可能性就会越高\\
但问题是合数的可能也会越来越高，所以我们把P叫做卡梅里克数\\
(听着挺无厘头的)
$$

## 举个🌰

> 经典561，证明561是一个卡梅里克数

$$
我们可以看到，561 = 3 × 11 × 17。因此，561是一个合数。\\
对于\forall a，使得1 < a < 561且gcd(a, 561) = 1，都有a^{561} \equiv a (mod \ 561)。\\
分解为三个小的同余方程\\
\begin{cases}
a^{561} \equiv a (mod \ 3)\implies a^{(3-1)} ≡ a^2 ≡ 1 (mod 3)\\
a^{561} \equiv a (mod \ 11) \implies a^{(11-1)} ≡ a^{10} ≡ 1 (mod 11)\\
a^{561} \equiv a (mod \ 17)\implies a^{(17-1)} ≡ a^{16} ≡ 1 (mod 17)\\
\end{cases}\\
$$

## 注意

> 卡梅里克数是无尽的

# 费马数

Fermat number

> 一种特殊形式(斐波那契数)的数的方法，其形式为正整数

$$
F_k=2^{2^k}+1\\
k=0\ \ F_0=3\\
k=1\ \ F_1=5\\
k=2\ \ F_2=17\\
k=3\ \ F_3=257\\
$$

## 性质

> 任何两个不同的Fermat数都是互质的，即它们的最大公约数是1
>
> 如果F_n是质数，那么n也必须是质数。然而，反之则不成立，即使n是质数，F_n也不一定是质数。
> $$
> n=F_k 是质数\iff3^{\frac{n-1}{2}}\equiv-1(mod\ n)
> $$
> 

# 梅森数

Mersenne number
$$
指形如M_n = 2^n - 1的自然数，n\in \N
$$

## 性质

- $$
  当n是合数时，M_n一定是合数。\\
  例如，M_4 = 15 = 3 × 5。\\
  当n是质数时，M_n可能是质数。\\例如，M_2 = 3，M_3 = 7，M_5 = 31都是质数\\
  如果M_n是质数，那么n也必须是质数。然而，反之则不成立，即使n是质数，M_n也不一定是质数。
  $$

  

## 注意

$$
如果M_n=2^n\\
n=ab\\
1<a\le b\\那么2^{ab}-1可以被2^a-1整除
$$

