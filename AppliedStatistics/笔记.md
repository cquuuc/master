# CDF:累计分布函数

$$
已知\ \begin{array}{c|lcr}
    y & \text{0} & \text{1} \\
    \hline
    P & \frac{1}{2} & \frac{1}{2}\\
\end{array},
\ n=1000,X=y_1+……+y_{1000}
\\求E(X),D(X),\sigma(X)
\\解:已知E(y)=\frac{1}{2}\\D(y)=E(y^2)-(E(y)^2)=\frac{1}{2} \cdot0^2+\frac{1}{2}\cdot1^2-(\frac{1}{2})^2=\frac{1}{4}\\
所以E(X)=1000\cdot\frac{1}{2}=500\\D(X)=1000\cdot\frac{1}{4}=250
\\\sigma(X)=\sqrt{D(X)}=\sqrt{250}\approx\sqrt{256}=16\\
且一般情况下满足标准正态分布\implies\frac{X-E(X)}{\sigma(X)}\backsim N(0,1)
\\同理普通正态分布为X \backsim N(\mu,\sigma^2),P(X)=\frac{1}{\sqrt{2\pi}\cdot\sigma}\cdot e^{-\frac{(x-\mu)^2}{2\cdot\sigma^2}}
\\若令Z=\frac{X-E(X)}{\sigma(X)}\implies Z \backsim N(0,1),P(Z)=\frac{1}{\sqrt{2\pi}}\cdot e^{-\frac{x^2}{2}}\\
那么P(Z\leq0.7)=\int_0^{0.7}P(Z)=\int_0^{0.7}\frac{1}{\sqrt{2\pi}}\cdot e^{-\frac{x^2}{2}}\cdot dx 
\\这样计算过于麻烦，于是引入了标准正态的一个累计分布函数CDF\\
\phi(a)=P(Z\leq a)
\\ \phi(a)=\int_{-\infty}^{a}\frac{1}{\sqrt{2\pi}}\cdot e^{-\frac{x^2}{2}}\cdot dx 
\\ \phi_0(a)=\int_{0}^{a}\frac{1}{\sqrt{2\pi}}\cdot e^{-\frac{x^2}{2}}\cdot dx 
\\
例如：要求P(x>\xi)=P(\frac{x-500}{16}>\frac{\xi-500}{16})
\\P(x>500)=P(\frac{x-500}{16}>\frac{500-500}{16})=P(Z>0)=1-\phi(0)
\\P(x>530)=P(\frac{x-530}{16}>\frac{530-500}{16})=P(Z>\frac{30}{16})=1-\phi(\frac{30}{16})
\\P(x>550)=P(\frac{x-550}{16}>\frac{550-500}{16})=P(Z>\frac{50}{16})=1-\phi(\frac{50}{16})
$$

# CLT:中心极限定理

$$
当n及其大的时候，E(X)=\mu，D(X)=\sigma^2\\
若X收敛则有X_1+……+X_n\backsim N(n\cdot\mu,n\cdot\sigma^2)\ or \ N(n\cdot\mu,(\sqrt{n}\cdot\sigma)^2)
\\三\sigma原则：\\还是上面的例子 \sigma=16，n=1000\\
\\P(\mu-\sigma<x<\mu+\sigma)=P(500-16<x<500+16)\approx0.68
\\P(\mu-2\sigma<x<\mu+2\sigma)=P(468<x<532)\approx0.96
\\P(\mu-3\sigma<x<\mu+3\sigma)=P(453<x<548)\approx0.999

\\ \color{yellow}{例题}\\
n=100求P(40\leq X\leq 60);n=1000求P(400\leq X\leq 600)
\\E(X)=\frac{1}{2},D(X)=\frac{1}{4}
\\E(X_{100})=\frac{1}{2}\cdot100=50,D(X_{100})=\frac{1}{4}\cdot100=25,\sigma(X_{100})=5
\\E(X_{1000})=\frac{1}{2}\cdot1000=500,D(X_{1000})=\frac{1}{4}\cdot1000=250,\sigma(X_{1000})=16
\\Z=\frac{X-E(X)}{\sigma(X)}
\\P(40\leq X\leq 60)=P(\frac{40-50}{5}\leq Z\leq \frac{60-50}{5})=P(-2\leq Z\leq 2)=\phi(2)-\phi(-2)
\\P(400\leq X\leq 600)=P(\frac{400-500}{16}\leq Z\leq \frac{600-500}{16})=P(-6.25\leq Z\leq 6.25)=\phi(6.25)-\phi(-6.25)
$$

# 联合概率分布随机变量的独立性

$$
x与y独立吗？\\

\\ \color{yellow}{例题1}\\ P_{x,y}=        \begin{cases}
            x+y,  & x,y\in[0,1] \\
            0, & other \\
        \end{cases}\\
        P_{x}=        \begin{cases}
            \int_0^1 (x+y)\cdot dy=x+\frac{1}{2} \\
            \int_0^1 0\cdot dy=0 \\
        \end{cases} \ \ \
          P_{y}=        \begin{cases}
            \int_0^1 (x+y)\cdot dx=y+\frac{1}{2} \\
            \int_0^1 0\cdot dx=0 \\
        \end{cases}\\
         P_{x,y}=        \begin{cases}
            (x+\frac{1}{2})\cdot (y+\frac{1}{2}) \\
            0 \\
        \end{cases}\neq \begin{cases}
            x+y \\
            0 \\
        \end{cases}\\不独立\\
\\ \color{yellow}{例题2}\\ P_{x,y}=        \begin{cases}
            4xy,  & x,y\in[0,1] \\
            0, & other \\
        \end{cases}\\
        P_{x}=        \begin{cases}
            \int_0^1 4xy\cdot dy=2x \\
            \int_0^1 0\cdot dy=0 \\
        \end{cases} \ \ \
          P_{y}=        \begin{cases}
            \int_0^1 4xy\cdot dx=2y \\
            \int_0^1 0\cdot dx=0 \\
        \end{cases}\\
         P_{x,y}=        \begin{cases}
            2x\cdot 2y \\
            0 \\
        \end{cases}= \begin{cases}
            x+y \\
            0 \\
        \end{cases}\\独立
$$

# 极大似然估计与矩估计

$$
\color{red}极大似然估计\\
对于离散的X\backsim p(x;\theta),\{x_1,...,x_n\}是一次观察值,那么事件\{X_1=x_1,...,X_n=x_n \}发生的概率为\\L(\theta)=\prod_{i=1}^np(x;\theta)\\
似然函数L(\theta)、极大然估计值\hat\theta\{x_1,...,x_n\}、极大然估计量(MLE) \ \hat\theta\{X_1,...,X_n \}
\\为了求L(\theta)最大值可以求\ 对数似然函数:lnL(\theta)最大
\\lnL(\theta)=\sum_{i=1}^{n} x_i\cdot lnp+(n-\sum_{i=1}^{n}x_i)\cdot ln(1-p)
\\\frac{\partial lnL(\theta)}{\partial\theta}=\frac{\sum x_i}{\theta}-\frac{n-\sum x_i}{1-\theta}\\
\hat\theta_{MLE}=\frac{1}{n}\sum x_i\\
\color{yellow}{例题，若X\backsim(\mu,\sigma^2),求\mu,\sigma^2的极大似然估计}\\
\color{lime}step1 \
\color{silver}已知P(x)=\frac{1}{\sqrt{2\pi}\cdot\sigma}\cdot e^{-\frac{(x-\mu)^2}{2\cdot\sigma^2}}\\令\mu=\theta_1,\sigma^2=\theta_2\implies P(x,\theta_1,\theta_2)=\frac{1}{\sqrt{2\pi}\cdot\theta_2^{\frac{1}{2}}}\cdot e^{-\frac{(x-\theta_1)^2}{2\cdot\theta_2}}\\
\color{lime}step2 \
\color{silver}L(\theta_1,\theta_2)=\prod_{i=1}^np(x,\theta_1,\theta_2)=(2\pi\theta_2)^{-\frac{n}{2}}\cdot e^{-\sum\frac{(x-\theta_1)^2}{2\theta_2}}\\
lnL(\theta_1,\theta_2)=-\frac{n}{2}ln(2\pi)-\frac{n}{2}ln(\theta_2)-\sum\frac{(x-\theta_1)^2}{2\theta_2}\\
\color{lime}step3 \
\color{silver}\frac{\partial lnL}{\partial\theta_1}=0-0+\frac{1}{\theta_2}\sum (x_i-\theta_1)=\frac{1}{\theta_2}(\sum x_i-n\theta_1)=0\\\implies \theta_1=\frac{\sum x_i}{n}=\bar x\\
\frac{\partial lnL}{\partial\theta_2}=-\frac{n}{2\theta_2}+\sum\frac{(x-\theta_1)^2}{2\theta_2^2}=0\implies\theta_2=\frac{1}{n}\sum(x_i-\theta_1)^2=\frac{1}{n}\sum(x_i-\bar x)^2=S_2
\\\color{red}矩估计\\
常见统计量:\\
原点矩M_k=E(x^k)=\frac{1}{n}\sum x_i^k\cdot P(X = x_i):\int[x^k \cdot f(x) dx]\\
样本矩(A_k): \frac{1}{n} \cdot \sum(x_i - A_1)^k\\
总体的累积量(B_k):\frac{1}{n}\cdot \sum\frac{i - 1} { n - 1} \cdot x_{i:n}\\
B_2=\frac{n-1}{n}S^2\\
\hat\sigma=\sqrt{A_2-{\bar X}^2}=\hat\sigma = \sqrt{\frac{1}{n-1} \sum (x_i - \bar X)^2}=\sqrt{B_2}\\

总体矩(M_k^*,μ_k):E[(X - μ_1)^k]=E[(X - \bar x)^k]\\
总体的中心矩(v_k):E[(X - E(X))^k]\\
D(x)=Var(x)=v_2=E[(X - E(X))^2]\\
\color{yellow}{例题，\begin{array}{c|lcr}
    x & \text{  5  } & \text{  11  } & \text{ 0 }\\
    \hline
    P & p_1 &p_2& 1-p_1-p_2 \\
\end{array},M_1=E(x)=\bar x,M_2=E(x^2)=\frac{1}{n}\sum x_i^2,求p_1,p_2}\\
M_1=E(x)=5p_1+11p_2=\bar x\ ,\ M_2=E(x^2)=25p_1+121p_2=\frac{1}{n}\sum x_i^2\\
两式代入消元，\begin{cases}
            \hat p_1=\frac{1}{30}(11\bar x -\frac{1}{n}\sum x_i^2) \\
             \hat p_2 =\frac{1}{66}(\frac{1}{n}\sum x_i^2-5\bar x)\\
        \end{cases}\\
\color{yellow}有数据\{0,5,5,11\},则\bar x =\frac{21}{4},\frac{1}{4}\sum_{i=1}^{4}x_i^2=\frac{171}{4}\\
代入求得\begin{cases}
            \hat p_1=\frac{1}{30}(\frac{231}{4}-\frac{171}{4})=\frac{1}{2} \\
             \hat p_2 =\frac{1}{66}(\frac{171}{4}-\frac{105}{4})=\frac{1}{4}\\
        \end{cases}\\
$$

# 最小方差无偏估计原理

$$
\hat\theta_1=U_1(x_1,...,x_n)\backsim random,\hat\theta_2=U_2(x_1,...,x_n)
\\1)E(\hat\theta)=\theta \ ?
\\\hat\theta_1=\bar x,\hat\theta_2=medion=\bar x
\\2) \lim_{n \to \infty}D(\hat\theta)=0 \ ?
\\if \ D(\hat\theta_1)<D(\hat\theta_2)\implies \hat\theta_1\ is\ better
\\
\\一个正态分布的总体X \backsim N(\mu,\sigma^2),均值为μ,方差为σ^2
\\我们从这个总体中随机抽取了一个容量为n的简单随机样本{x_1, x_2, ..., x_n}。\\现在我们希望估计总体的均值μ。有以下两个估计量:
\\样本均值: \hatμ_1 = \frac{1}{n} \sum_{i=1}^n x_i
\\
别的估计量: \hatμ_2 = \frac{1}{n+1} \sum_{i=1}^n x_i
\\
哪个估计量是总体均值μ的最小方差无偏估计?\\
E(\hatμ_1) = E(\frac{1}{n} \sum_{i=1}^n x_i) = \frac{1}{n} \sum_{i=1}^n E(x_i) = \frac{1}{n} \cdot nμ = μ\\


E(\hatμ_2) = E(\frac{1}{n+1} \sum_{i=1}^n x_i) = \frac{1}{n+1} \sum_{i=1}^n E(x_i) = \frac{1}{n+1} \cdot nμ = \frac{n}{n+1}μ ≠ μ\\
从上面的计算可以看出,ˆμ_1是总体均值μ的无偏估计,而ˆμ_2不是无偏估计。\\因此,我们不需要计算ˆμ_2的方差,因为它已经不满足无偏性条件。\\
D(\hat	μ_1) = D(\frac{1}{n} \sum_{i=1}^n x_i) = \frac{1}{n^2} \sum_{i=1}^n Var(x_i) = \frac{1}{n^2} \cdot nσ^2 = \frac{σ^2}{n}\\所以,在这个例子中,样本均值ˆμ_1是总体均值μ的最小方差无偏估计。\\它不仅满足无偏性条件,而且方差最小,保证了估计的稳定性和可靠性。
$$

# 习题

## 1)

A diagnostic test for a certain disease is applied to n individuals known to not have the disease. Let X = the number among the n test results that are positive (indicating presence of the disease, so X is the number of false positives) and p 5 the probability that a disease-free individual’s test result is positive (i.e., p is the true proportion of test results from disease-free individuals that are positive). Assume that only X is available rather than the actual sequence of test results.对n个已知没有患病的人进行某种疾病的诊断测试。设X = n个检测结果中阳性的数量（表示存在该疾病，因此X为假阳性的数量），p 5为无病个体检测结果为阳性的概率（即p为无病个体检测结果为阳性的真实比例）。假设只有X可用，而不是测试结果的实际序列。

- Derive the maximum likelihood estimator of p. If n = 20 and x = 3, what is the estimate?推导p的最大似然估计量。如果n = 20, x = 3，估计是多少？
  $$
  L(p)=p^{\sum x_i}\cdot (1-p)^{n-\sum x_i}
  \\ \hat p_{MLE}=\frac{1}{n}\sum x_i =\bar x=\frac{3}{20}
  $$
  

- Is the estimator of part (a) unbiased?(a)部分的估计量是否无偏？
  $$
  E(\hat p)=E(\frac{1}{n}\sum y_i )=\frac{1}{n}\sum E(y_i)=\frac{1}{n}\cdot n\cdot p=p 
  $$
  

- If n = 20 and x = 3, what is the mle of the probability (1 − p)5  that none of the next five tests done on disease-free individuals are positive?如果n = 20, x = 3，对无病个体进行的接下来五次检测均为阳性的概率（1 - p）5的平方是多少？
  $$
  \hat{(1-p)^5}=0\\
  f(\hat p)=f(p)\\
  {(1-p)^5}=(1-\frac{3}{20})^5
  $$
  

## 2)

Let X denote the proportion of allotted time that a randomly selected student spends working on a certain aptitude test. Suppose the pdf of X is设X表示随机选择的学生花在某项能力倾向测试上的时间所占的比例。假设X的pdf是
$$
f (x , θ) = \begin{cases}
            (θ + 1)x^θ,  &  0 ≤ x ≤ 1 \\
            0, & \text{otherwise} \\
        \end{cases}
$$
where θ > −1. A random sample of ten students yields data x1 = 0.92, x2 = 0.79, x3 = 0.90, x4 = 0.65, x5 = 0.86, x6 = 0.47, x7 = 0.73, x8 = 0.97, x9 = 0.94, x10 = 0.77.  式中θ >−1。随机抽样10名学生得到的数据x1 = 0.92, x2 = 0.79, x3 = 0.90, x4 = 0.65, x5 = 0.86, x6 = 0.47, x7 = 0.73, x8 = 0.97, x9 = 0.94, x10 = 0.77。

- Use the method of moments to obtain an estimator of θ, and then compute the estimate for this data.用矩量法得到θ的估计量，然后计算该数据的估计。
  $$
  E(x)=\int_{-\infin}^{+\infin}x\cdot f(x,\theta)dx=\int_{0}^{1}x(\theta + 1)x^\theta dx\\=\frac{\theta+1}{\theta+2}x^{\theta+2} \huge{|}\normalsize ^{1}_{0}=\frac{\theta+1}{\theta+2}=\bar x\implies\theta=\frac{1-2\bar x}{\bar x-1}\\
  \hat\theta_{MM}=\frac{1-2\bar x}{\bar x-1}
  $$
  

- Obtain the maximum likelihood estimator of θ, and then compute the estimate for the given data.得到θ的极大似然估计量，然后计算给定数据的估计。
  $$
  L(\theta)=\prod_{i=1}^nf(x_i,\theta)=\prod_{i=1}^n(\theta+1)x_i^\theta=(\theta+1)^n(\prod_{i=1}^nx_i)^{\theta}\\
  lnL(\theta)=n\cdot ln(\theta+1)+\theta\sum_{i=1}^{n}lnx_i\\
  \frac{\partial lnL(\theta)}{\partial\theta}=n\cdot\frac{1}{\theta+1}+\sum_{i=1}^{n}lnx_i=0
  \\\implies\theta=\frac{\sum lnx_i}{n}-1\\
  \hat\theta_{MLE}=\frac{\sum lnx_i}{n}-1\\
  $$
  

# 样本方差的期望值是否为总体方差的无偏估计

$$
E(\hat\mu)=E(\frac{1}{n}\cdot n \cdot \mu)=\mu\\
E(\hat\sigma^2)=E(\frac{1}{n} \sum_{i=1}^n (x_i - \bar x)^2)=\frac{1}{n}\sum_{i=1}^{n}E((x_i - \bar x)^2)=\frac{1}{n}\sum_{i=1}^{n}D(x_i - \bar x)\\
若i=1时则有D(x_1 - \bar x)=D(x_i - \frac{\sum x}{n})=D(x_1-\frac{1}{n}x_1-\frac{1}{n}x_2-...-\frac{1}{n}x_n)\\=D(\frac{n-1}{n}x_1-...-\frac{1}{n}x_n)\\=(\frac{n-1}{n})^2\ D(x_1)+(-\frac{1}{n})^2\ D(x_2)+...+(-\frac{1}{n})^2\ D(x_n)\\=(\frac{n-1}{n})^2\ \sigma^2+ \overbrace{(-\frac{1}{n})^2\ \sigma^2+...+(-\frac{1}{n})^2\ \sigma^2}^{\text{n-1个}} \\
=(\frac{(n-1)^2}{n^2}+\frac{n-1}{n^2})\sigma^2=\frac{(n-1)\cdot n}{n^2}\sigma^2=\frac{n-1}{n}\sigma^2\\
所以\frac{1}{n}\sum_{i=1}^{n}D(x_i - \bar x)=\frac{1}{n}\cdot n \cdot\frac{n-1}{n}\sigma^2=\frac{n-1}{n}\sigma^2\\
所以E(\hat\sigma^2)=E(\frac{1}{n} \sum_{i=1}^n (x_i - \bar x)^2)=\frac{n-1}{n}\sigma^2\\
其中E(\frac{n}{n-1}\hat\sigma^2)=\overbrace{E(\frac{1}{n-1} \sum_{i=1}^n (x_i - \bar x)^2)=E(S^2)}^{S^2 = \frac{1}{n-1} \sum_{i=1}^n (x_i - \bar x)^2}=\sigma^2

\\\\
$$

# 梯度下降